<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Chat communautaire Big Dreams</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
      background: #f5f5f5;
    }

    #chat {
      border: 1px solid #ccc;
      background: white;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 10px;
    }

    #message {
      width: 80%;
      padding: 10px;
    }

    #sendBtn {
      padding: 10px 20px;
    }
  </style>
</head>
<body>

  <h1>Chat communautaire Big Dreams</h1>

  <div id="chat"></div>

  <input id="username" type="text" placeholder="Ton pseudo"
    style="width: 100%; margin-bottom:10px; padding: 10px;" />

  <input id="message" type="text" placeholder="Écris ton message..." />
  <button id="sendBtn">Envoyer</button>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>

  <script>
    // ✅ Ta configuration Firebase personnalisée
    const firebaseConfig = {
      apiKey: "AIzaSyAayX0yoC9kESc-QAnrOvMUoanummDQ92U",
      authDomain: "posetonprobleme.firebaseapp.com",
      databaseURL: "https://posetonprobleme-default-rtdb.firebaseio.com",
      projectId: "posetonprobleme",
      storageBucket: "posetonprobleme.appspot.com",
      messagingSenderId: "172852914305",
      appId: "1:172852914305:web:9c1dd2fb973fbe0d81c580",
      measurementId: "G-VM5V3WTWKW"
    };

    // 🔧 Initialiser Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 🎯 DOM elements
    const chatDiv = document.getElementById('chat');
    const sendBtn = document.getElementById('sendBtn');
    const messageInput = document.getElementById('message');
    const usernameInput = document.getElementById('username');

    // 📩 Envoi de message
    sendBtn.onclick = () => {
      const username = usernameInput.value.trim();
      const message = messageInput.value.trim();

      if (!username) return alert('Merci de saisir un pseudo');
      if (!message) return alert('Merci d\'écrire un message');

      db.ref('messages').push({
        name: username,
        text: message,
        timestamp: Date.now()
      });

      messageInput.value = '';
    };

    // 🔁 Afficher les messages en temps réel
    db.ref('messages').orderByChild('timestamp').limitToLast(50).on('child_added', snapshot => {
      const msg = snapshot.val();
      const msgElem = document.createElement('p');
      msgElem.innerHTML = `<strong>${msg.name}:</strong> ${msg.text}`;
      chatDiv.appendChild(msgElem);
      chatDiv.scrollTop = chatDiv.scrollHeight;
    });
  </script>

</body>
</html>